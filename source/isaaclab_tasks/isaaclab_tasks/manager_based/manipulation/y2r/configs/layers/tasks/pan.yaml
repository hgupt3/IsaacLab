# ==============================================================================
# Pan Task Layer - Pick Up, Lift, Place Down
# ==============================================================================
# Task definition only - no play/mode settings.
# Pan: start (on table) -> waypoint (lift) -> goal (return to start)
# ==============================================================================

# Observations: Filter out pan handle from point cloud observations
# This prevents the policy from tracking handle points (only track the pan body)
observations:
  point_cloud_filter:
    enabled: true               # Set true to enable handle filtering
    axis: "x"                   # Filter along height axis in object-local frame
    min: -0.13                   # Lower bound for filter (meters)
    max: null                   # Upper bound for filter (null = no limit)

# Hand trajectory: grasp from handle side (approach from +Y)
hand_trajectory:
  grasp_sampling:
    # Fixed direction grasp: approach from handle side
    fixed_origin_offset: [0, 0, 0]           # Grasp at pan center
    fixed_direction: [0, 0, 1]          # Approach from handle side
    fixed_hand_roll: 0.0               # Roll for handle grasp
    exclude_toward_robot: false         # Allow full range of motion
    # Pre-grasp approach
    approach_distance: 0.0             # Pre-grasp distance (meters)
    align_fraction: 1.0                 # Fraction of grasp phase to reach pre-grasp

  keypoints:
    count: [0, 0]                       # No in-hand manipulation keypoints

trajectory:
  segments:
    - name: "grasp"
      type: "waypoint"
      pose: null              # Computed: start_poses
      duration: 2.5

    - name: "lift"
      type: "waypoint"
      # Lifted position
      pose: [-0.55, -0.1, 0.375, 1.0, 0.0, 0.0, 0.0]
      duration: 2.0

    - name: "goal"
      type: "waypoint"
      pose: null              # Computed: goal_poses
      duration: 2.0

    - name: "release"
      type: "waypoint"
      pose: null              # Object stays at goal
      duration: 2.0
      hand_coupling: "none"   # Hand decouples and retreats

push_t:
  enabled: true
  object_usd: "assets/pan/pan.usd"
  outline_usd: "assets/pan/pan_outline.usd"  # Outline asset for goal visualization
  object_scale: 2.5
  outline_position: [-0.75, -0.1]       # Goal position for pan
  object_rotation: [1.0, 0.0, 0.0, 0.0] # Pan orientation
  outline_rotation: [1.0, 0.0, 0.0, 0.0]
  rolling_window: 2.5
  min_speed: 0.05

goal:
  x_range: [-0.55, -0.55]
  y_range: [-0.1, -0.1]

randomization:
  object:
    scale: [0.9, 0.9]                   # Fixed scale
    mass_scale: [2.0, 2.0]
  reset:
    object_x: [-0.1, -0.1]               # X variation
    object_y: [0.15, 0.25]               # Y variation
    object_yaw: [1.0, 0.0]             # Yaw variation

terminations:
  trajectory_deviation:
    position_threshold: [1.0, 1.0]      # Position threshold (meters)
    rotation_threshold: [3.14, 3.14]      # Rotation threshold (radians)
  hand_pose_deviation:
    position_threshold: [1.0, 1.0]      # Position threshold (meters)
    rotation_threshold: [3.14, 3.14]

procedural_objects:
  generation:
    num_shapes: 0  
