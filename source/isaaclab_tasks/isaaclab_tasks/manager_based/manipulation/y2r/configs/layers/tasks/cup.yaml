# ==============================================================================
# Cup Task Layer - Pour and Return
# ==============================================================================
# Task definition only - no play/mode settings.
# Bottle: start (upright) -> waypoint (pour above cup) -> goal (return to start)
# ==============================================================================

# Hand trajectory: side grasp from +Y (right side viewer POV / left side robot POV)
hand_trajectory:
  grasp_sampling:
    # Fixed direction grasp: approach from +Y side of bottle
    fixed_origin_offset: [0, 0, -0.05]  # Offset above bottle center (Z)
    fixed_direction: [-1, 0, 0]         # Look from -Y direction to find surface point
    fixed_hand_roll: 0.0               # Roll for side grasp
    exclude_toward_robot: false         # Disable constraint to allow full roll range
    # Pre-grasp approach
    approach_distance: 0.15   # Pre-grasp distance (meters)
    align_fraction: 0.7      # Fraction of grasp phase to reach pre-grasp

  keypoints:
    count_weights: [1.0]        # No additional grasp keypoints

trajectory:
  segments:
    - name: "grasp"
      type: "waypoint"
      pose: null              # Computed: start_poses
      duration: 3.0

    - name: "pour"
      type: "waypoint"
      # Pour position: above cup with pour tilt
      pose: [-0.55, 0.12, 0.423, 0.707, -0.707, 0.0, 0.0]
      duration: 4.5

    - name: "return"
      type: "waypoint"
      pose: null              # Computed: returns to start_poses
      duration: 4.0

    - name: "release"
      type: "waypoint"
      pose: null              # Object stays at return position
      duration: 2.0
      hand_coupling_weights:
        none: 1.0             # Hand decouples and retreats

push_t:
  enabled: true
  object_usd: "assets/bottle/bottle.usd"
  outline_usd: "assets/cup/cup.usd"
  object_scale: 0.75
  outline_position: [-0.55, 0.23]
  object_rotation: [1.0, 0.0, 0.0, 0.0]
  outline_rotation: [1.0, 0.0, 0.0, 0.0]
  rolling_window: 2.5
  min_speed: 0.05

goal:
  return_to_start: true         # Return bottle to original position

randomization:
  object:
    scale: [1.5, 1.5]
  reset:
    object_x: [-0.1, 0.1]
    object_y: [-0.2, 0.1]
    object_yaw: [0.0, 0.0]

terminations:
  trajectory_deviation:
    position_threshold: [1.0, 1.0]
    rotation_threshold: [3.14, 3.14]
  hand_pose_deviation:
    position_threshold: [1.0, 1.0]         # Position threshold (meters)
    rotation_threshold: [3.14, 3.14]          # Rotation threshold (radians)

procedural_objects:
  generation:
    num_shapes: 0  
